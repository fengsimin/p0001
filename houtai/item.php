<?php
//Copyright (c) 2016 iFeiwu.com
 class Item extends Ifeiwu { public function __construct() { goto aGvXb; BSZ1y: $this->table = "\x69\164\145\x6d"; goto gFK1v; gFK1v: Ew1Gp: goto fmTK6; aGvXb: if ($this->table) { goto Ew1Gp; } goto BSZ1y; fmTK6: parent::__construct(); goto HSLq0; HSLq0: } protected function postPage($request_data) { goto u3b3D; RiQmP: $page = $page ? $page - 1 : 0; goto J7Ltl; MMmJt: OCDwo: goto QBFAQ; zQ6Hs: $order = $request_data["\x6f\x72\144\x65\x72"] ?: $this->order; goto FahpB; MMj6S: goto OCDwo; goto A3h3W; q1Cep: $data = $this->db->select($this->table, $column)->where($where)->order($order)->all(); goto MMj6S; MqPGJ: $page = $request_data["\x70\x61\147\145"] ?: 1; goto RiQmP; lsJ9i: $where = $request_data["\167\150\x65\x72\x65"] ?: "\61\40\75\x20\x31"; goto zQ6Hs; A3h3W: GcYiN: goto MqPGJ; B8jjC: $column = $request_data["\x63\157\x6c\165\x6d\x6e"] ?: "\52"; goto lsJ9i; FahpB: $perpage = $request_data["\x70\145\162\160\141\x67\x65"] ?: 0; goto Rr5w_; u3b3D: $this->_callback("\143\x61\154\x6c\x62\141\x63\x6b\120\141\x67\x65\102\145\x66\157\162\145", array(&$request_data)); goto B8jjC; H5BH3: $list = $this->db->select($this->table, $column)->where($where)->order($order)->limit(array($page * $perpage, $perpage))->all(); goto v1Yuu; Rr5w_: if ($perpage > 0) { goto GcYiN; } goto q1Cep; fegy6: return $this->success($data); goto szQCC; v1Yuu: $data = array("\x6c\151\163\164" => $list, "\x74\157\164\141\154" => $total, "\160\145\162\160\x61\x67\145" => $perpage, "\x70\x61\147\145" => $page); goto MMmJt; J7Ltl: $total = $this->db->select($this->table)->where($where)->count(); goto H5BH3; QBFAQ: $this->_callback("\143\141\154\x6c\142\x61\x63\x6b\120\x61\x67\145\101\146\164\145\162", array(&$data)); goto fegy6; szQCC: } protected function postQuery($request_data) { goto jjvoL; tChD1: HXIuC: goto pwMGW; jjvoL: $sql = $request_data["\163\x71\154"]; goto ALJRB; pwMGW: return $this->db->query($sql, $request_data["\166\141\x6c\x75\145\163"])->all(); goto f4Jhf; tIo28: $sql = str_replace("\x24\x74\141\142\154\145", $this->prefix . $this->table, $sql); goto tChD1; ALJRB: if (!(stripos($sql, "\44\x74\141\x62\x6c\x65") !== false)) { goto HXIuC; } goto tIo28; f4Jhf: } protected function getOne($id, $column = null) { goto dZvXA; dZvXA: $column = $column ?: "\x2a"; goto U2zQg; U2zQg: $data = $this->db->select($this->table, $column)->where(array("\x69\144", "\75", $id))->get(); goto n_JA5; n_JA5: return $this->success($data); goto lnO_h; lnO_h: } protected function postAdd($request_data) { goto pzCOC; xfMtM: $udata = array("\x69\144" => $id); goto cIOw1; tgTP4: if (!($pid > 0 && in_array("\154\x65\166\145\154", $this->fields))) { goto xMZbI; } goto WFNHi; VvhlZ: $udata[$upload_name] = $upload_path; goto R7YNa; tIF2J: $data = $this->_bulidData($request_data); goto Pipvi; pzCOC: $this->_callback("\143\141\154\x6c\x62\x61\143\x6b\101\144\x64\x42\x65\x66\x6f\x72\145", array(&$request_data)); goto tSvuT; cIOw1: $pid = $data["\x70\151\144"]; goto tgTP4; wxnbJ: $this->_log("\141\x64\x64", array("\x74\x69\164\154\x65" => $data["\164\151\164\154\145"], "\164\x61\x62\x6c\145\x5f\151\x64" => $id)); goto jST0g; g2fpq: $this->_callback("\143\x61\154\x6c\142\x61\143\x6b\x41\x64\x64\x41\x66\x74\145\162", array($id, &$request_data)); goto wxnbJ; yBUoV: if (!($upload_name && $upload_path)) { goto isdTA; } goto QFqs9; dJ4rg: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto VvhlZ; QFqs9: $data["\151\x64"] = $id; goto dJ4rg; Es_Vb: if ($id) { goto ilo2G; } goto CoEZz; aStPz: return $this->success("\xe6\xb7\273\345\x8a\240\346\x95\260\xe6\215\xae\346\x88\220\345\212\x9f\xef\274\201", array("\x69\x64" => $id, "\151\x6d\141\x67\x65\x5f\x70\141\x74\x68" => $upload_path)); goto yo3Cg; xN0Et: if ($this->db->update($this->table, $udata, array("\151\x64", "\75", $id))->is()) { goto yiydq; } goto Ct13W; qDVZG: ilo2G: goto xfMtM; CoEZz: return $this->error("\xe6\267\273\345\x8a\240\xe6\225\xb0\346\x8d\xae\xe5\244\xb1\350\264\245\xef\274\x81"); goto qDVZG; M7UZO: $id = $this->db->insert($this->table, $data)->id(); goto Es_Vb; Ct13W: $this->db->rollBack(); goto LT9JM; R7YNa: isdTA: goto xN0Et; tIQxg: yiydq: goto g2fpq; caWmZ: $upload_name = $request_data["\44\x75\x70\154\157\x61\144\x5f\x6e\141\x6d\x65"]; goto Z9R54; Pipvi: $data["\x63\164\151\155\x65"] = time(); goto RtFhm; ND46L: goto yrDwp; goto tIQxg; yo3Cg: yrDwp: goto jcNBe; RtFhm: $this->db->beginTransaction(); goto M7UZO; Z9R54: $upload_path = $request_data["\x24\165\160\154\157\141\x64\137\x70\x61\164\x68"]; goto yBUoV; WFNHi: $udata["\154\145\166\x65\154"] = $this->_getLevel($pid, $id); goto DNfPS; DNfPS: xMZbI: goto caWmZ; tSvuT: $this->_removeFiles2($request_data["\137\162\145\155\157\x76\x65\146\x69\154\145\x73"]); goto tIF2J; LT9JM: return $this->error("\xe6\xb7\xbb\345\212\xa0\346\x95\260\346\x8d\256\xe5\xa4\261\350\xb4\xa5\357\xbc\201"); goto ND46L; jST0g: $this->db->commit(); goto aStPz; jcNBe: } protected function postUpdate($id, $request_data) { goto FdxdJ; JH_PY: LLS22: goto VJR_f; Zqg7f: UyBBL: goto BfkAg; OMAGy: $this->_removeFiles2($request_data["\x5f\x72\x65\x6d\x6f\x76\x65\146\x69\154\145\x73"]); goto wVk8R; FdxdJ: $this->_callback("\x63\x61\x6c\x6c\142\x61\143\x6b\125\160\144\x61\164\145\102\145\146\x6f\162\x65", array(&$request_data)); goto OMAGy; nzwas: goto LLS22; goto Zqg7f; dJKYt: if (!($upload_name && $upload_path)) { goto MUOIf; } goto lRh7v; VfGDO: $this->_log("\x75\x70\x64\x61\x74\145", array("\164\151\164\154\x65" => $data["\x74\151\x74\154\x65"])); goto NAR67; d2H3q: if (!($pid > 0 && in_array("\154\x65\166\145\x6c", $this->fields))) { goto Ok8WQ; } goto YiznW; NAR67: return $this->success("\xe5\xb7\xb2\xe4\277\235\345\xad\x98\xe6\233\264\xe6\x94\xb9\xef\xbc\x81"); goto JH_PY; GfFbP: $pid = $data["\x70\x69\x64"]; goto d2H3q; WF9oe: Ok8WQ: goto V_RZW; wVk8R: $data = $this->_bulidData($request_data); goto HlYO6; LDKvp: RHOhr: goto T254T; BfkAg: $this->_callback("\143\141\154\x6c\x62\141\143\153\x55\160\x64\x61\164\145\x41\146\x74\145\x72", array($id, &$request_data)); goto VfGDO; VKoHk: $upload_path = $request_data["\44\x75\160\x6c\157\141\144\x5f\x70\141\x74\150"]; goto dJKYt; lc0Xm: return $this->error("\xe4\277\235\345\xad\x98\xe5\244\xb1\350\264\245\357\xbc\201"); goto nzwas; YiznW: $data["\x6c\x65\166\145\154"] = $this->_getLevel($pid, $id); goto WF9oe; XMJfL: $data[$upload_name] = $upload_path; goto LDKvp; HlYO6: $data["\165\x74\151\x6d\x65"] = time(); goto GfFbP; T254T: MUOIf: goto PHeeY; hgkYr: if (!in_array($upload_name, $this->fields)) { goto RHOhr; } goto XMJfL; V_RZW: $upload_name = $request_data["\x24\x75\160\154\x6f\141\144\x5f\x6e\141\155\x65"]; goto VKoHk; PHeeY: if ($this->db->update($this->table, $data, array("\151\x64", "\x3d", $id))->is()) { goto UyBBL; } goto lc0Xm; lRh7v: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto hgkYr; VJR_f: } protected function postField($request_data) { goto nQeo4; GQ1Il: goto oUmwk; goto E6OEq; E6OEq: XirYl: goto tStSd; b2Id7: return $this->error(); goto GQ1Il; tStSd: return $this->success(); goto m9U4W; nQeo4: $ids = $request_data["\x69\144"]; goto Nv6Hd; tooaz: if ($this->db->update($this->table, array($name => $value), array("\151\144", "\111\x4e", $ids))->is()) { goto XirYl; } goto b2Id7; m9U4W: oUmwk: goto ClRdA; KlEFa: $value = $request_data["\166\141\x6c\165\145"]; goto tooaz; Nv6Hd: $name = $request_data["\x6e\x61\x6d\145"]; goto KlEFa; ClRdA: } protected function postCount($request_data) { goto cb459; XUs6D: $where = $request_data["\167\x68\145\x72\x65"] ?: "\61\40\x3d\40\x31"; goto zfG41; zfG41: return $this->db->select($table)->where($where)->count(); goto Qj4JX; cb459: $table = $request_data["\164\x61\142\x6c\x65"] ?: $this->table; goto XUs6D; Qj4JX: } protected function postDelete($request_data) { goto N1R7L; cs2Qa: return $this->error("\346\x9c\211\40" . count($error) . "\xe6\235\241\346\225\xb0\346\215\256\xe5\x88\xa0\351\231\244\xe5\244\261\350\264\245\357\274\201"); goto NWvZQ; ZiagK: $this->_callback("\x63\x61\154\x6c\x62\141\143\153\104\x65\154\x65\x74\145\101\146\164\x65\162", array(&$request_data)); goto jIdTt; NWvZQ: goto U9lN1; goto y149Q; YwKVS: if (count($error) === 0) { goto wMKXL; } goto KoihL; y149Q: wMKXL: goto ZiagK; y5o6s: $ids = $request_data["\x69\144"]; goto oRXuw; oRXuw: $this->db->beginTransaction(); goto qUw5e; KoihL: $this->db->rollBack(); goto cs2Qa; vBBob: return $this->success(); goto iTL3T; WENY3: $error = array(); goto y5o6s; N1R7L: $this->_callback("\x63\141\x6c\x6c\x62\x61\143\x6b\104\145\154\x65\x74\145\x42\x65\x66\x6f\162\145", array(&$request_data)); goto WENY3; UemUY: $this->_log("\162\145\155\x6f\x76\145", array("\164\x69\164\154\x65" => count($ids))); goto vBBob; jIdTt: $this->db->commit(); goto UemUY; qUw5e: foreach ($ids as $id) { goto j9mM3; j9mM3: $item = $this->db->select($this->table)->where(array("\151\144", "\x3d", $id))->get(); goto r9VnX; JZHr7: goto p7yBZ; goto oCCbp; vEJGD: p7yBZ: goto ahW1N; oCCbp: goto HFwM6; goto wln5Z; aveKn: HFwM6: goto vEJGD; IknvL: $error[] = $id; goto JZHr7; wln5Z: Lw7hh: goto uLwqg; uLwqg: $this->_trash($item, $request_data); goto aveKn; r9VnX: if ($this->db->delete($this->table, array("\x69\144", "\75", $id))->is()) { goto Lw7hh; } goto IknvL; ahW1N: } goto Idboz; iTL3T: U9lN1: goto vL2cm; Idboz: h7tHS: goto YwKVS; vL2cm: } }
